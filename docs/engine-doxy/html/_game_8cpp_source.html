<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>The Dungeon Throne: Game.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">The Dungeon Throne
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">A Modifiable 3D Dungeon Management Game</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_game_8cpp_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Game.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &lt;lppscript/LppScript.hpp&gt;</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &lt;systems/EntitySystem.hpp&gt;</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &lt;systems/HealthSystem.hpp&gt;</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;systems/MovementSystem.hpp&gt;</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;systems/AISystem.hpp&gt;</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &lt;systems/InputSystem.hpp&gt;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &lt;systems/GridSystem.hpp&gt;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &lt;systems/TaskSystem.hpp&gt;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;systems/CombatSystem.hpp&gt;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;systems/ProductionSystem.hpp&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;systems/TimeSystem.hpp&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;systems/EventSystem.hpp&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;systems/GraphicsSystem.hpp&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;systems/TriggerSystem.hpp&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;systems/ManaSpellSystem.hpp&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;systems/WaveSystem.hpp&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;tools/Grid.hpp&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;tools/Player.hpp&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;tools/LevelGenerators.hpp&gt;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;tools/Spellcaster.hpp&gt;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;tools/Camera.hpp&gt;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;tools/SelectionBox.hpp&gt;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &lt;tools/EntityPlacer.hpp&gt;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;tools/GameSerializer.hpp&gt;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;gui/GUI.hpp&gt;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;gui/EntityCreator.hpp&gt;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;Game.hpp&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;LuaInterface.hpp&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="class_game.html#ad59df6562a58a614fda24622d3715b65">   30</a></span>&#160;<a class="code" href="class_game.html#ad59df6562a58a614fda24622d3715b65">Game::Game</a>() <span class="comment">// TODO: Init systems.</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    : state_{GAME_STATE::INTRO_MENU}, <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>{}, window_{},</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;      scene_mgr_{}, <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>{}, main_light_{},</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      main_view_{}, input_{}, keyboard_{}, mouse_{},</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <a class="code" href="class_game.html#a55d453a75a2abc8a0b2ba4ad6265b8c3">renderer_</a>{}, <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>{}, <a class="code" href="class_game.html#a8e687faa09ca8c2f89279eecbe463916">ground_</a>{},</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>{}, <a class="code" href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">entity_creator_</a>{},</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <a class="code" href="class_game.html#abd514cad4e3b88d5ab87e8f2e966fd4a">mouse_position_</a>{}, <a class="code" href="class_game.html#a180d400b3d9f3781f31822f9141704b2">level_generator_</a>{}, <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>{},</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <a class="code" href="class_game.html#add2c7263d03befb832ce112ccf09b3eb">throne_id_</a>{Component::NO_ENTITY}</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;{</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_camera.html">Camera</a>{});</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="class_game.html#a6c94b1e2b66f522a3ccfe4294d0311d9">ogre_init</a>();</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    ois_init();</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    cegui_init();</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <a class="code" href="class_game.html#ac04dd2e6cc4b77fa09d234446ff7d1ca">windowResized</a>(window_); <span class="comment">// Will adjust dimensions for OIS mouse.</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_entity_system.html">EntitySystem</a>{*scene_mgr_});</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    health_system_.reset(<span class="keyword">new</span> <a class="code" href="class_health_system.html">HealthSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    movement_system_.reset(<span class="keyword">new</span> <a class="code" href="class_movement_system.html">MovementSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    input_system_.reset(<span class="keyword">new</span> <a class="code" href="class_input_system.html">InputSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, *keyboard_, *(<a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;camera_)});</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    grid_system_.reset(<span class="keyword">new</span> <a class="code" href="class_grid_system.html">GridSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, *scene_mgr_});</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    combat_system_.reset(<span class="keyword">new</span> <a class="code" href="class_combat_system.html">CombatSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, *scene_mgr_, *grid_system_});</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    event_system_.reset(<span class="keyword">new</span> <a class="code" href="class_event_system.html">EventSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    task_system_.reset(<span class="keyword">new</span> <a class="code" href="class_task_system.html">TaskSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, *grid_system_, *combat_system_});</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    production_system_.reset(<span class="keyword">new</span> <a class="code" href="class_production_system.html">ProductionSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    time_system_.reset(<span class="keyword">new</span> <a class="code" href="class_time_system.html">TimeSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    ai_system_.reset(<span class="keyword">new</span> <a class="code" href="class_a_i_system.html">AISystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    graphics_system_.reset(<span class="keyword">new</span> <a class="code" href="class_graphics_system.html">GraphicsSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    trigger_system_.reset(<span class="keyword">new</span> <a class="code" href="class_trigger_system.html">TriggerSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    mana_spell_system_.reset(<span class="keyword">new</span> <a class="code" href="class_mana_spell_system.html">ManaSpellSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    wave_system_.reset(<span class="keyword">new</span> <a class="code" href="class_wave_system.html">WaveSystem</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>.get());</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(health_system_.get());</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(movement_system_.get());</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(ai_system_.get());</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(input_system_.get());</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(grid_system_.get());</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(task_system_.get());</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(combat_system_.get());</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(production_system_.get());</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(time_system_.get());</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(event_system_.get());</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(graphics_system_.get());</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(trigger_system_.get());</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(mana_spell_system_.get());</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>.emplace_back(wave_system_.get());</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_selection_box.html">SelectionBox</a>{<span class="stringliteral">&quot;MainSelectionBox&quot;</span>, *<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>,</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                          *scene_mgr_-&gt;createPlaneBoundedVolumeQuery(Ogre::PlaneBoundedVolumeList{}),</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                                          *scene_mgr_-&gt;createRayQuery(Ogre::Ray{}), *scene_mgr_});</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_entity_placer.html">EntityPlacer</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, *grid_system_, *scene_mgr_});</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">entity_creator_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_entity_creator.html">EntityCreator</a>{*<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>, *<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="class_game.html#a27543a5588f79f251f5b4cb64026966f">game_serializer_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_game_serializer.html">GameSerializer</a>{*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>});</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="class_game.html#a180d400b3d9f3781f31822f9141704b2">level_generator_</a>.reset(<span class="keyword">new</span> <a class="code" href="classlevel__generators_1_1_random_level_generator.html">level_generators::DEFAULT_LEVEL_GENERATOR</a>(*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, 10));</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    <span class="keyword">auto</span>&amp; gui = <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>();</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    gui.init(<span class="keyword">this</span>);</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="class_lua_interface.html#ac9fa6b609503a1db2c44b7f27f8d1090">LuaInterface::init</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">entity_creator_</a>-&gt;init(gui.get_window(<span class="stringliteral">&quot;ENTITY_MANAGER&quot;</span>));</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    gui.get_research().init(gui.get_window(<span class="stringliteral">&quot;RESEARCH&quot;</span>));</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="class_player.html#a9a4272f12d53223a552c27a064e65187">Player::instance</a>().<a class="code" href="class_player.html#a30c0caf810fab1b1676a6ce4f76b1f42">init</a>(<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>.get());</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>.reset(<span class="keyword">new</span> <a class="code" href="class_spellcaster.html">Spellcaster</a>(*<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>, *<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>));</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    gui.get_spell_casting().set_caster(<a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>.get());</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="class_player.html#a9a4272f12d53223a552c27a064e65187">Player::instance</a>().<a class="code" href="class_player.html#a150b3f80378da1ab09eef2a59cf9b173">set_initial_unlocks</a>(gui.get_spell_casting().get_spells(),</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                                           gui.get_builder().get_buildings());</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="comment">// Wave system has it&#39;s countdown label directly wired to the GUI.</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    wave_system_-&gt;set_countdown_window(<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().get_window(<span class="stringliteral">&quot;NEXT_WAVE/NEXT_LABEL&quot;</span>));</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <a class="code" href="class_game.html#a57ad62417505d7230bc46b37def4f1d0">create_empty_level</a>(16, 16); <span class="comment">// In case initial load fails.</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;look_at(<a class="code" href="class_grid.html#a6ce0a23ca91244b4eee86ba8072cb56d">Grid::instance</a>().get_center_position(*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>));</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;}</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno"><a class="line" href="class_game.html#ae3d112ca6e0e55150d2fdbc704474530">  104</a></span>&#160;<a class="code" href="class_game.html#ae3d112ca6e0e55150d2fdbc704474530">Game::~Game</a>()</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;{</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    Ogre::WindowEventUtilities::removeWindowEventListener(window_, <span class="keyword">this</span>);</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="class_game.html#a6d4e1f9eca561e5d10f46e2453df8d9b">windowClosed</a>(window_);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;}</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno"><a class="line" href="class_game.html#a1ab78f5ed0d5ea879157357cf2fb2afa">  110</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a1ab78f5ed0d5ea879157357cf2fb2afa">Game::run</a>()</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;{</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    scene_mgr_-&gt;setAmbientLight(Ogre::ColourValue(.5, .5, .5));</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="class_game.html#a27543a5588f79f251f5b4cb64026966f">game_serializer_</a>-&gt;load_game(*<span class="keyword">this</span>, <span class="stringliteral">&quot;intro_dummy_level&quot;</span>);</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;startRendering();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;}</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="class_game.html#a484567626eb22fe9fc65c51a3914e230">  118</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a484567626eb22fe9fc65c51a3914e230">Game::update</a>(tdt::real delta)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;{</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#a57b2102ded949460275f6c06a73ef472">get_top_bar</a>().<a class="code" href="class_top_bar.html#a8641f2accd0f13d2262669914582cb69">update_time</a>(delta);</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    CEGUI::System::getSingleton().injectTimePulse((<span class="keywordtype">float</span>)delta);</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().get_console().is_visible())</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ae407027b2e7e81f8132ee7dd5252c456">get_console</a>().<a class="code" href="class_console.html#ac3fa9f9078ac81af758ad0bec7a10bf8">update_fps</a>(delta, window_-&gt;getLastFPS());</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::RUNNING || <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::INTRO_MENU)</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; sys : <a class="code" href="class_game.html#af594421c81bec3f6284ccdb8d3888080">systems_</a>)</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            sys-&gt;update(delta);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    }</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// Camera movement caused by mouse.</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;get_free_mode())</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    {</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">auto</span>&amp; mouse = CEGUI::System::getSingleton().getDefaultGUIContext().getMouseCursor();</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keyword">auto</span> width = main_view_-&gt;getActualWidth();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">auto</span> height = main_view_-&gt;getActualHeight();</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">auto</span> pos = mouse.getPosition();</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        <span class="keywordflow">if</span>(pos.d_x &lt; 10.f)</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;move(DIRECTION::LEFT, delta);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pos.d_x &gt; width - 10.f)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;            <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;move(DIRECTION::RIGHT, delta);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pos.d_y &lt; 10.f)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;            <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;move(DIRECTION::DOWN, delta);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(pos.d_y &gt; height - 10.f)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;move(DIRECTION::UP, delta);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;update(delta); <span class="comment">// Additional movement caused by keys.</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">else</span> <span class="comment">// Movement cause by keys (this one includes elevation).</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;update(delta);</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;}</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="class_game.html#a5daa13180764435151f08925edd144a3">  154</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a5daa13180764435151f08925edd144a3">Game::set_state</a>(GAME_STATE state)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;{</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::INTRO_MENU || <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::MENU)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;       &amp;&amp; state != GAME_STATE::RUNNING &amp;&amp; state != GAME_STATE::ENDED)</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// Invalid transition.</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> != state)</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span>(state == GAME_STATE::RUNNING)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;            <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#a37c94218f5c1d9d9b955ee7796ba9247">set_visible</a>(<span class="stringliteral">&quot;MESSAGE&quot;</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(state == GAME_STATE::PAUSED)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#a37c94218f5c1d9d9b955ee7796ba9247">set_visible</a>(<span class="stringliteral">&quot;MESSAGE&quot;</span>, <span class="keyword">true</span>);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> = state;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    }</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;}</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno"><a class="line" href="class_game.html#af379c92d7e4e03982bcbeb53f4d3edb5">  172</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#af379c92d7e4e03982bcbeb53f4d3edb5">Game::new_game</a>(tdt::uint width, tdt::uint height)</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;{</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ac5d029ac1d5be5f405d0bb9b4beaadeb">get_log</a>().<a class="code" href="class_game_log.html#a8e8630c1d2b3899de9a90473fd46c415">clear</a>();</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#af7f76a45f16144b8217938de6facb97d">get_message</a>().<a class="code" href="class_g_u_i_window.html#afaa290bb3bb0020e676bb546d942e528">set_visible</a>(<span class="keyword">false</span>);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="class_game.html#a57ad62417505d7230bc46b37def4f1d0">create_empty_level</a>(width, height);</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    wave_system_-&gt;clear_spawn_nodes();</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="class_game.html#a64bfdd3eb56fb04275ec65bfa3ae12f6">reset_unlocks</a>();</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="class_player.html#a9a4272f12d53223a552c27a064e65187">Player::instance</a>().<a class="code" href="class_player.html#a1af5d39f7bac2aeaa1e30c7dda2332fa">reset</a>();</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classlpp_1_1_script.html#a9ca5b255301a8e9a1aedc15e62fe677c">lpp::Script::instance</a>().call&lt;bool, tdt::uint, tdt::uint&gt;(<span class="stringliteral">&quot;game.init_level&quot;</span>, width, height))</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <a class="code" href="class_game.html#a180d400b3d9f3781f31822f9141704b2">level_generator_</a>-&gt;generate(width, height, *wave_system_);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    wave_system_-&gt;start();</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;}</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno"><a class="line" href="class_game.html#a57ad62417505d7230bc46b37def4f1d0">  186</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a57ad62417505d7230bc46b37def4f1d0">Game::create_empty_level</a>(tdt::uint width, tdt::uint height)</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;{</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>-&gt;delete_entities();</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>-&gt;cleanup();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    Ogre::SceneNode* ground_node{};</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    { <span class="comment">// Recreate if already exists.</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        ground_node = <a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>-&gt;getParentSceneNode();</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        ground_node-&gt;detachObject(<a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        scene_mgr_-&gt;destroyEntity(<a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        scene_mgr_-&gt;destroySceneNode(ground_node);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        <span class="keyword">auto</span>&amp; mesh_mgr = Ogre::MeshManager::getSingleton();</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">if</span>(mesh_mgr.resourceExists(<span class="stringliteral">&quot;ground&quot;</span>))</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            mesh_mgr.unload(<span class="stringliteral">&quot;ground&quot;</span>);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            mesh_mgr.remove(<span class="stringliteral">&quot;ground&quot;</span>);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        mesh_mgr.unloadUnreferencedResources();</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    }</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    tdt::real actual_width{width * 100.f - 100.f}, actual_height{height * 100.f - 100.f};</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="class_game.html#a8e687faa09ca8c2f89279eecbe463916">ground_</a>.reset(<span class="keyword">new</span> Ogre::Plane{Ogre::Vector3::UNIT_Y, 0});</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    Ogre::MeshManager::getSingleton().createPlane(</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;        <span class="stringliteral">&quot;ground&quot;</span>, Ogre::ResourceGroupManager::DEFAULT_RESOURCE_GROUP_NAME,</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        *<a class="code" href="class_game.html#a8e687faa09ca8c2f89279eecbe463916">ground_</a>, actual_width, actual_height, 20, 20, <span class="keyword">true</span>, 1, (tdt::real)width, (tdt::real)height, Ogre::Vector3::UNIT_Z</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    );</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a> = scene_mgr_-&gt;createEntity(<span class="stringliteral">&quot;ground&quot;</span>);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    ground_node = scene_mgr_-&gt;getRootSceneNode()-&gt;createChildSceneNode();</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>-&gt;setCastShadows(<span class="keyword">false</span>);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    ground_node-&gt;attachObject(<a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    ground_node-&gt;setPosition((width * 100.f - 100.f) / 2.f, 0.f, (height * 100.f - 100.f) / 2.f);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>-&gt;setMaterialName(<span class="stringliteral">&quot;rocky_ground&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">ground_entity_</a>-&gt;setQueryFlags(0);</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="class_grid.html#a6ce0a23ca91244b4eee86ba8072cb56d">Grid::instance</a>().<a class="code" href="class_grid.html#a23e1873e2854d15170ae8565e46a1729">create_graph</a>(*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>, Ogre::Vector2{0, 0}, width, height, 100.f);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// Adjust camera.</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;set_start(Ogre::Vector2{actual_width / 2 - 300.f, actual_height / 2 - 300.f},</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                         <a class="code" href="class_grid.html#a6ce0a23ca91244b4eee86ba8072cb56d">Grid::instance</a>().<a class="code" href="class_grid.html#ad31b555e83f82a18c1c4a483bf1e57e5">get_center_position</a>(*<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>), 400.f);</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;reset();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;}</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;</div><div class="line"><a name="l00231"></a><span class="lineno"><a class="line" href="class_game.html#a4faa3b6fdf7446e3e432d3a7cf49e6b2">  231</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a4faa3b6fdf7446e3e432d3a7cf49e6b2">Game::reset_camera</a>()</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;{</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;reset();</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;}</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="class_game.html#a64bfdd3eb56fb04275ec65bfa3ae12f6">  236</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a64bfdd3eb56fb04275ec65bfa3ae12f6">Game::reset_unlocks</a>()</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">auto</span>&amp; spellcaster = <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ad68dfd48d702edbc8eae79b02ef694db">get_spell_casting</a>();</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keyword">auto</span>&amp; builder = <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#a3533e8d1c67c8cd1643be0b6d640e489">get_builder</a>();</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keyword">auto</span>&amp; player = <a class="code" href="class_player.html#a9a4272f12d53223a552c27a064e65187">Player::instance</a>();</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    spellcaster.clear_spells();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    builder.clear_buildings();</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; spell : player.get_initial_spells())</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        spellcaster.register_spell(spell);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; building : player.get_initial_buildings())</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        builder.register_building(building);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#a8f8dae1e40b3f25c179cd088631e9e24">get_research</a>().<a class="code" href="class_research_window.html#a47234d07778e8f3a29b0be59ce6c275f">reset_research</a>();</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;}</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;</div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="class_game.html#a20ded9865809df42b8e6d6dd5292351c">  254</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a20ded9865809df42b8e6d6dd5292351c">Game::set_throne_id</a>(tdt::uint <span class="keywordtype">id</span>)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;{</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <a class="code" href="class_game.html#add2c7263d03befb832ce112ccf09b3eb">throne_id_</a> = id;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;}</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="class_game.html#a11e7bc665ccfcd21403f8fad66deb24e">  259</a></span>&#160;tdt::uint <a class="code" href="class_game.html#a11e7bc665ccfcd21403f8fad66deb24e">Game::get_throne_id</a>()<span class="keyword"> const</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="class_game.html#add2c7263d03befb832ce112ccf09b3eb">throne_id_</a>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="class_game.html#a7595cce82f9d32a21ac96663d5927e2b">  264</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#a7595cce82f9d32a21ac96663d5927e2b">Game::frameRenderingQueued</a>(<span class="keyword">const</span> Ogre::FrameEvent&amp; event)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;{</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    keyboard_-&gt;capture();</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    mouse_-&gt;capture();</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <a class="code" href="class_game.html#a484567626eb22fe9fc65c51a3914e230">update</a>(event.timeSinceLastFrame);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    CEGUI::System::getSingleton().injectTimePulse((<span class="keywordtype">float</span>)event.timeSinceLastFrame); <span class="comment">// Update CEGUI.</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::ENDED)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;}</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno"><a class="line" href="class_game.html#afa42cb4d67e91e865f0df410a3950c33">  278</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#afa42cb4d67e91e865f0df410a3950c33">Game::keyPressed</a>(<span class="keyword">const</span> OIS::KeyEvent&amp; event)</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;{</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">switch</span>(event.key)</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        <span class="keywordflow">case</span> OIS::KC_ESCAPE:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().escape_pressed())</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> != GAME_STATE::INTRO_MENU)</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <a class="code" href="class_game.html#a5daa13180764435151f08925edd144a3">set_state</a>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::RUNNING ? GAME_STATE::PAUSED : GAME_STATE::RUNNING);</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;set_visible(<span class="keyword">false</span>);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;stop_casting();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="keywordflow">case</span> OIS::KC_GRAVE:</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">if</span>(keyboard_-&gt;isModifierDown(OIS::Keyboard::Modifier::Shift))</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                <a class="code" href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">entity_creator_</a>-&gt;set_visible(!<a class="code" href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">entity_creator_</a>-&gt;is_visible());</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ae407027b2e7e81f8132ee7dd5252c456">get_console</a>().<a class="code" href="class_console.html#a501dafcea40b76808dec9fce5817f54a">set_visible</a>(!<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().get_console().is_visible());</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">case</span> OIS::KC_NUMPAD0:</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;            <a class="code" href="class_game.html#a25c49dd9183cb89c0c3e3c34d69389c7">toggle_camera_free_mode</a>();</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="comment">// Pass to CEGUI.</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keyword">auto</span>&amp; cont = CEGUI::System::getSingleton().getDefaultGUIContext();</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    <span class="keyword">auto</span> b1 = cont.injectKeyDown((CEGUI::Key::Scan)event.key);</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">auto</span> b2 = cont.injectChar((CEGUI::Key::Scan)event.text);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">if</span>(b1 || b2) <span class="comment">// Guarantees both key and char injection.</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> != GAME_STATE::RUNNING)</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// Camera movement.</span></div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().get_console().is_visible())</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;key_pressed((CEGUI::Key::Scan)event.key);</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno"><a class="line" href="class_game.html#a30dbe1a49eeef33b8bfdba3275e03b81">  318</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#a30dbe1a49eeef33b8bfdba3275e03b81">Game::keyReleased</a>(<span class="keyword">const</span> OIS::KeyEvent&amp; event)</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;{</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// Pass to CEGUI and Options (for key bindings).</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span>(CEGUI::System::getSingleton().getDefaultGUIContext().injectKeyUp((CEGUI::Key::Scan)event.key))</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> != GAME_STATE::RUNNING)</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// Camera movement.</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().get_console().is_visible())</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;key_released((CEGUI::Key::Scan)event.key);</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#adf043e9ed8ec60a8ac7f981dbd3d7933">get_options</a>().<a class="code" href="class_options_window.html#a35feca3b435b2205f72138f65d20cf5d">key_pressed</a>((CEGUI::Key::Scan)event.key);</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    }</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;get_spell_type() == SPELL_TYPE::GLOBAL ||</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;       (<a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;get_spell_type() == SPELL_TYPE::TARGETED &amp;&amp;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;       <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities().size() == 1))</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;cast();</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;}</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;</div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="class_game.html#af65edfac010ab689d4f1750de04a3635">  348</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#af65edfac010ab689d4f1750de04a3635">Game::mouseMoved</a>(<span class="keyword">const</span> OIS::MouseEvent&amp; event)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;get_free_mode() &amp;&amp; <span class="keyword">event</span>.state.buttonDown(OIS::MB_Right))</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    {</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;yaw(Ogre::Degree(-.13f * event.state.X.rel));</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;pitch(Ogre::Degree(-.13f * event.state.Y.rel));</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="comment">// Update CEGUI mouse position. TODO: Do this only if GUI is visible?</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">auto</span>&amp; gui_cont = CEGUI::System::getSingleton().getDefaultGUIContext();</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    gui_cont.injectMouseMove((<span class="keywordtype">float</span>)event.state.X.rel, (<span class="keywordtype">float</span>)event.state.Y.rel);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">if</span>(event.state.Z.rel != 0) <span class="comment">// Mouse scroll.</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        gui_cont.injectMouseWheelChange(event.state.Z.rel / 120.f); <span class="comment">// Note: 120.f is a magic number used by MS, might not be</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                                                                    <span class="comment">//       cross-platform.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="keyword">auto</span> pos = <a class="code" href="class_game.html#a215e7330ada9260773a74ad0347dd638">get_mouse_click_position</a>(event);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span>(pos.first)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    { <span class="comment">// Save mouse position, so that it can be retrieved form Lua.</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;        <a class="code" href="class_game.html#abd514cad4e3b88d5ab87e8f2e966fd4a">mouse_position_</a>.x = pos.second.x;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="class_game.html#abd514cad4e3b88d5ab87e8f2e966fd4a">mouse_position_</a>.y = pos.second.z;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;is_visible() &amp;&amp; pos.first)</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;update_position(pos.second);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;is_selecting())</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keyword">auto</span>&amp; mouse = gui_cont.getMouseCursor();</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        Ogre::Vector2 end{ <span class="comment">// Can&#39;t use get_mouse_click_position as this is rendered in 2D.</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            mouse.getPosition().d_x / (float)event.state.width,</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            mouse.getPosition().d_y / (float)event.state.height</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        };</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;extend_to(end);</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;</div><div class="line"><a name="l00384"></a><span class="lineno"><a class="line" href="class_game.html#a08e8d993e88ef586468a19ad3c45479c">  384</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#a08e8d993e88ef586468a19ad3c45479c">Game::mousePressed</a>(<span class="keyword">const</span> OIS::MouseEvent&amp; event, OIS::MouseButtonID <span class="keywordtype">id</span>)</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;{</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keyword">auto</span>&amp; gui_context = CEGUI::System::getSingleton().getDefaultGUIContext();</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span>(gui_context.injectMouseButtonDown(<a class="code" href="class_game.html#a8a1c953c9c8ca4ef292e5fa6fec4dcb0">ois_to_cegui</a>(<span class="keywordtype">id</span>)) || <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::MENU)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Left &amp;&amp; !<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;is_visible())</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    { <span class="comment">// Start selection.</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keyword">auto</span>&amp; mouse = gui_context.getMouseCursor();</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        Ogre::Vector2 position_screen{ <span class="comment">// Mouse position on the screen -&gt; NOT IN GRID!</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            mouse.getPosition().d_x / (float)event.state.width,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            mouse.getPosition().d_y / (float)event.state.height</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        };</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;set_starting_point(position_screen);</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;clear();</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;set_selecting(<span class="keyword">true</span>);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;is_casting())</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    {</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Left &amp;&amp; <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::RUNNING</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;           &amp;&amp; !(<a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;get_spell_type() == SPELL_TYPE::TARGETED &amp;&amp;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities().size() != 1))</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        {</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;            <span class="keyword">auto</span> position_grid = <a class="code" href="class_game.html#a215e7330ada9260773a74ad0347dd638">get_mouse_click_position</a>(event); <span class="comment">// This is position wrt to the grid.</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            <span class="keywordflow">if</span>(position_grid.first)</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;cast(Ogre::Vector2{position_grid.second.x, position_grid.second.z});</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;        }</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Right)</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;        {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;set_visible(<span class="keyword">false</span>);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;stop_casting();</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        }</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;is_visible())</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    {</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Left &amp;&amp; ((<a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;can_place_when_game_paused() &amp;&amp; <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::PAUSED)</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;           || <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::RUNNING))</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;place();</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Right)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            <a class="code" href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">placer_</a>-&gt;set_visible(<span class="keyword">false</span>);</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    }</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;}</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;</div><div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="class_game.html#a32b8ef3a9f1d9103ad4560ca212c2ab1">  435</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_game.html#a32b8ef3a9f1d9103ad4560ca212c2ab1">Game::mouseReleased</a>(<span class="keyword">const</span> OIS::MouseEvent&amp; event, OIS::MouseButtonID <span class="keywordtype">id</span>)</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;    <span class="keyword">auto</span>&amp; gui_context = CEGUI::System::getSingleton().getDefaultGUIContext();</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    gui_context.injectMouseButtonUp(<a class="code" href="class_game.html#a8a1c953c9c8ca4ef292e5fa6fec4dcb0">ois_to_cegui</a>(<span class="keywordtype">id</span>));</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> == GAME_STATE::MENU)</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">if</span>(<span class="keywordtype">id</span> == OIS::MB_Left &amp;&amp; <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;is_selecting())</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    {</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        <span class="keyword">auto</span>&amp; mouse = gui_context.getMouseCursor();</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        Ogre::Vector2 end{</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            mouse.getPosition().d_x / (float)event.state.width,</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;            mouse.getPosition().d_y / (float)event.state.height</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        };</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;execute_selection(end, *(<a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;camera_), keyboard_-&gt;isKeyDown(OIS::KC_LSHIFT));</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities().size() == 1)</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;            <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ab197361fb542ae6f1761be27346ec6bd">get_tracker</a>().<a class="code" href="class_entity_tracker.html#abff80cf0f55c307745c5f88f219099a1">set_tracked_entity</a>(<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities()[0], *<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities().empty())</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            <a class="code" href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a>().<a class="code" href="class_g_u_i.html#ab197361fb542ae6f1761be27346ec6bd">get_tracker</a>().<a class="code" href="class_entity_tracker.html#abff80cf0f55c307745c5f88f219099a1">set_tracked_entity</a>(Component::NO_ENTITY, *<a class="code" href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">entity_system_</a>);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;set_selecting(<span class="keyword">false</span>);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    }</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">selection_box_</a>-&gt;get_selected_entities().size() == 1 &amp;&amp; <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;get_spell_type() == SPELL_TYPE::TARGETED ||</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;       <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;get_spell_type() == SPELL_TYPE::GLOBAL)</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    {</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <a class="code" href="class_game.html#a16f63fa6189119f189b90129558af639">spell_caster_</a>-&gt;cast();</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;}</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno"><a class="line" href="class_game.html#ac04dd2e6cc4b77fa09d234446ff7d1ca">  471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#ac04dd2e6cc4b77fa09d234446ff7d1ca">Game::windowResized</a>(Ogre::RenderWindow* window)</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span>(window != window_) <span class="comment">// For the possibility of more windows.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    tdt::uint width, height, depth;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordtype">int</span> left, top;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    window-&gt;getMetrics(width, height, depth, left, top);</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="comment">// This synchronizes the mouse with the new window size.</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keyword">auto</span>&amp; mouse_state = mouse_-&gt;getMouseState();</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    mouse_state.width = width;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    mouse_state.height = height;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;}</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno"><a class="line" href="class_game.html#a6d4e1f9eca561e5d10f46e2453df8d9b">  485</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a6d4e1f9eca561e5d10f46e2453df8d9b">Game::windowClosed</a>(Ogre::RenderWindow* window)</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;{</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="keywordflow">if</span>(window != window_)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// For the possibility of more windows.</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="keywordflow">if</span>(input_)</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    { <span class="comment">// OIS cleanup.</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        input_-&gt;destroyInputObject(mouse_);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        input_-&gt;destroyInputObject(keyboard_);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        OIS::InputManager::destroyInputSystem(input_);</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        mouse_ = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        keyboard_ = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        input_ = <span class="keyword">nullptr</span>;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    }</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    </div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">state_</a> = GAME_STATE::ENDED;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;}</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="class_game.html#a6c94b1e2b66f522a3ccfe4294d0311d9">  503</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a6c94b1e2b66f522a3ccfe4294d0311d9">Game::ogre_init</a>()</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;{</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    Ogre::String plugs, res;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#ifdef _DEBUG</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    plugs = <span class="stringliteral">&quot;plugins_d.cfg&quot;</span>;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    res = <span class="stringliteral">&quot;resources_d.cfg&quot;</span>;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    plugs = <span class="stringliteral">&quot;plugins.cfg&quot;</span>;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    res = <span class="stringliteral">&quot;resources.cfg&quot;</span>;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>.reset(<span class="keyword">new</span> Ogre::Root{plugs});</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    Ogre::ConfigFile cf;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    cf.load(res);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="comment">// Load resource settings.</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    Ogre::String name, loc_type, group;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keyword">auto</span> selit = cf.getSectionIterator();</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">while</span>(selit.hasMoreElements())</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    {</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        group = selit.peekNextKey();</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        Ogre::ConfigFile::SettingsMultiMap* settings = selit.getNext();</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">for</span>(<span class="keyword">auto</span>&amp; x : *settings)</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        {</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            loc_type = x.first;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            name = x.second;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            Ogre::ResourceGroupManager::getSingleton().addResourceLocation(name, loc_type, group);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        }</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    Ogre::ResourceGroupManager::getSingleton().initialiseAllResourceGroups();</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">if</span>(!(<a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;restoreConfig() || <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;showConfigDialog()))</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    {   <span class="comment">// Configuration read failed, end the game.</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;        <span class="keywordflow">throw</span> std::exception{<span class="stringliteral">&quot;[Error] Failed to create or load config file.&quot;</span>};</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    }</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;initialise(<span class="keyword">false</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="comment">// Window init.</span></div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="preprocessor">#ifdef _DEBUG</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    window_ = <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;createRenderWindow(<span class="stringliteral">&quot;Dungeon Keeper&quot;</span>, 1920, 1080, <span class="keyword">false</span>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    window_ = <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;initialise(<span class="keyword">true</span>, <span class="stringliteral">&quot;Dungeon Keeper&quot;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    window_-&gt;setVisible(<span class="keyword">true</span>);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <span class="comment">// Scene init.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// TODO: Research different types of scene managers!</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    scene_mgr_ = <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;createSceneManager(Ogre::ST_GENERIC);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="keyword">auto</span> main_cam = scene_mgr_-&gt;createCamera(<span class="stringliteral">&quot;MainCam&quot;</span>);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    main_cam-&gt;setPosition(0, 300, 0);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    main_cam-&gt;lookAt(300, 0, 300);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    main_cam-&gt;setNearClipDistance(5);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    main_view_ = window_-&gt;addViewport(main_cam);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    main_cam-&gt;setAspectRatio(tdt::real(main_view_-&gt;getActualWidth()) /</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                              tdt::real(main_view_-&gt;getActualHeight()));</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    main_light_ = scene_mgr_-&gt;createLight(<span class="stringliteral">&quot;MainLight&quot;</span>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    main_light_-&gt;setPosition(20, 80, 50);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    main_light_-&gt;setVisible(<span class="keyword">false</span>); <span class="comment">// Currently using Light Crystals.</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    Ogre::WindowEventUtilities::addWindowEventListener(window_, <span class="keyword">this</span>);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">root_</a>-&gt;addFrameListener(<span class="keyword">this</span>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;init(main_cam);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;}</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="keywordtype">void</span> Game::ois_init()</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;{</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    OIS::ParamList pl;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    tdt::uint whnd = 0;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    std::string whnd_str{};</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    window_-&gt;getCustomAttribute(<span class="stringliteral">&quot;WINDOW&quot;</span>, &amp;whnd);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    whnd_str = std::to_string(whnd);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    pl.insert(std::make_pair(std::string(<span class="stringliteral">&quot;WINDOW&quot;</span>), whnd_str));</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    input_ = OIS::InputManager::createInputSystem(pl);</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    keyboard_ = <span class="keyword">static_cast&lt;</span>OIS::Keyboard*<span class="keyword">&gt;</span>(input_-&gt;createInputObject(OIS::OISKeyboard, <span class="keyword">true</span>));</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    mouse_ = <span class="keyword">static_cast&lt;</span>OIS::Mouse*<span class="keyword">&gt;</span>(input_-&gt;createInputObject(OIS::OISMouse, <span class="keyword">true</span>));</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    keyboard_-&gt;setEventCallback(<span class="keyword">this</span>);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    mouse_-&gt;setEventCallback(<span class="keyword">this</span>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;}</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keywordtype">void</span> Game::cegui_init()</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;{</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <a class="code" href="class_game.html#a55d453a75a2abc8a0b2ba4ad6265b8c3">renderer_</a> = &amp;CEGUI::OgreRenderer::bootstrapSystem(*window_);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    CEGUI::ImageManager::setImagesetDefaultResourceGroup(<span class="stringliteral">&quot;Imagesets&quot;</span>);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    CEGUI::Font::setDefaultResourceGroup(<span class="stringliteral">&quot;Fonts&quot;</span>);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    CEGUI::Scheme::setDefaultResourceGroup(<span class="stringliteral">&quot;Schemes&quot;</span>);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    CEGUI::WidgetLookManager::setDefaultResourceGroup(<span class="stringliteral">&quot;LookNFeel&quot;</span>);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    CEGUI::WindowManager::setDefaultResourceGroup(<span class="stringliteral">&quot;Layouts&quot;</span>);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    CEGUI::SchemeManager::getSingleton().createFromFile(<span class="stringliteral">&quot;AlfiskoSkin.scheme&quot;</span>);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    CEGUI::FontManager::getSingleton().createFromFile(<span class="stringliteral">&quot;Inconsolata-8.font&quot;</span>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    CEGUI::FontManager::getSingleton().createFromFile(<span class="stringliteral">&quot;Inconsolata-10.font&quot;</span>);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    CEGUI::FontManager::getSingleton().createFromFile(<span class="stringliteral">&quot;Inconsolata-14.font&quot;</span>);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    CEGUI::System::getSingleton().getDefaultGUIContext().setDefaultFont(<span class="stringliteral">&quot;Inconsolata-14&quot;</span>);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    CEGUI::System::getSingleton().getDefaultGUIContext().getMouseCursor().setDefaultImage(<span class="stringliteral">&quot;AlfiskoSkin/MouseArrow&quot;</span>);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    CEGUI::System::getSingleton().getDefaultGUIContext().getMouseCursor().setImage(CEGUI::System::getSingleton().getDefaultGUIContext().getMouseCursor().getDefaultImage());</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="comment">//CEGUI::System::getSingleton().getDefaultGUIContext().setDefaultTooltipType(&quot;AlfiskoSkin/Tooltip&quot;); // no support :(</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    CEGUI::WindowManager&amp; wmgr = CEGUI::WindowManager::getSingleton();</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    CEGUI::Window* sheet = wmgr.createWindow(<span class="stringliteral">&quot;DefaultWindow&quot;</span>, <span class="stringliteral">&quot;MainWindow/Sheet&quot;</span>);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    sheet-&gt;setMousePassThroughEnabled(<span class="keyword">true</span>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    CEGUI::System::getSingleton().getDefaultGUIContext().setRootWindow(sheet);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;}</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="class_game.html#a8a1c953c9c8ca4ef292e5fa6fec4dcb0">  611</a></span>&#160;CEGUI::MouseButton <a class="code" href="class_game.html#a8a1c953c9c8ca4ef292e5fa6fec4dcb0">Game::ois_to_cegui</a>(OIS::MouseButtonID <span class="keywordtype">id</span>)</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;{</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="keywordflow">switch</span>(<span class="keywordtype">id</span>)</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        <span class="keywordflow">case</span> OIS::MB_Left:</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="keywordflow">return</span> CEGUI::LeftButton;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">case</span> OIS::MB_Right:</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="keywordflow">return</span> CEGUI::RightButton;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;        <span class="keywordflow">case</span> OIS::MB_Middle:</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <span class="keywordflow">return</span> CEGUI::MiddleButton;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="keywordflow">return</span> CEGUI::LeftButton;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    }</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;}</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="class_game.html#a25c49dd9183cb89c0c3e3c34d69389c7">  626</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_game.html#a25c49dd9183cb89c0c3e3c34d69389c7">Game::toggle_camera_free_mode</a>()</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;{</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;set_free_mode(!<a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;get_free_mode());</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;}</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno"><a class="line" href="class_game.html#a215e7330ada9260773a74ad0347dd638">  631</a></span>&#160;std::pair&lt;bool, Ogre::Vector3&gt; <a class="code" href="class_game.html#a215e7330ada9260773a74ad0347dd638">Game::get_mouse_click_position</a>(<span class="keyword">const</span> OIS::MouseEvent&amp; event)<span class="keyword"> const</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keyword">auto</span>&amp; mouse = CEGUI::System::getSingleton().getDefaultGUIContext().getMouseCursor();</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <span class="keywordtype">float</span> screen_x = mouse.getPosition().d_x / (float)event.state.width;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <span class="keywordtype">float</span> screen_y = mouse.getPosition().d_y / (float)event.state.height;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;    Ogre::Ray ray = <a class="code" href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">main_cam_</a>-&gt;camera_-&gt;getCameraToViewportRay(screen_x, screen_y);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keyword">auto</span> res = ray.intersects(*<a class="code" href="class_game.html#a8e687faa09ca8c2f89279eecbe463916">ground_</a>);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keyword">auto</span> pos = ray.getPoint(res.second);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">return</span> std::make_pair(res.first, pos);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;}</div><div class="ttc" id="class_game_html_a08e8d993e88ef586468a19ad3c45479c"><div class="ttname"><a href="class_game.html#a08e8d993e88ef586468a19ad3c45479c">Game::mousePressed</a></div><div class="ttdeci">bool mousePressed(const OIS::MouseEvent &amp;, OIS::MouseButtonID) override</div><div class="ttdoc">Called when a mouse button is pressed. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00384">Game.cpp:384</a></div></div>
<div class="ttc" id="class_options_window_html_a35feca3b435b2205f72138f65d20cf5d"><div class="ttname"><a href="class_options_window.html#a35feca3b435b2205f72138f65d20cf5d">OptionsWindow::key_pressed</a></div><div class="ttdeci">bool key_pressed(CEGUI::Key::Scan)</div><div class="ttdoc">Registers a key press for keybinding. </div><div class="ttdef"><b>Definition:</b> <a href="_options_window_8cpp_source.html#l00026">OptionsWindow.cpp:26</a></div></div>
<div class="ttc" id="class_game_html_a6d4e1f9eca561e5d10f46e2453df8d9b"><div class="ttname"><a href="class_game.html#a6d4e1f9eca561e5d10f46e2453df8d9b">Game::windowClosed</a></div><div class="ttdeci">void windowClosed(Ogre::RenderWindow *rw) override</div><div class="ttdoc">Called when the window is closed. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00485">Game.cpp:485</a></div></div>
<div class="ttc" id="class_grid_system_html"><div class="ttname"><a href="class_grid_system.html">GridSystem</a></div><div class="ttdoc">Represents the pathfinding graph used by the game and provides several methods related to pathfinding...</div><div class="ttdef"><b>Definition:</b> <a href="_grid_system_8hpp_source.html#l00011">GridSystem.hpp:11</a></div></div>
<div class="ttc" id="class_entity_placer_html"><div class="ttname"><a href="class_entity_placer.html">EntityPlacer</a></div><div class="ttdoc">Class allowing the player/developer to place entities on the ground. </div><div class="ttdef"><b>Definition:</b> <a href="_entity_placer_8hpp_source.html#l00015">EntityPlacer.hpp:15</a></div></div>
<div class="ttc" id="class_entity_system_html"><div class="ttname"><a href="class_entity_system.html">EntitySystem</a></div><div class="ttdoc">The EntitySystem class handles everything related to entities, like addition and removal of component...</div><div class="ttdef"><b>Definition:</b> <a href="_entity_system_8hpp_source.html#l00021">EntitySystem.hpp:21</a></div></div>
<div class="ttc" id="class_console_html_a501dafcea40b76808dec9fce5817f54a"><div class="ttname"><a href="class_console.html#a501dafcea40b76808dec9fce5817f54a">Console::set_visible</a></div><div class="ttdeci">void set_visible(bool) override</div><div class="ttdoc">Changes the visibility and text capturing of the console window. </div><div class="ttdef"><b>Definition:</b> <a href="_console_8cpp_source.html#l00028">Console.cpp:28</a></div></div>
<div class="ttc" id="class_production_system_html"><div class="ttname"><a href="class_production_system.html">ProductionSystem</a></div><div class="ttdoc">System taking care of entities spawned by buildings and the spawn counts allowing for a constant amou...</div><div class="ttdef"><b>Definition:</b> <a href="_production_system_8hpp_source.html#l00014">ProductionSystem.hpp:14</a></div></div>
<div class="ttc" id="class_game_html_ae3d112ca6e0e55150d2fdbc704474530"><div class="ttname"><a href="class_game.html#ae3d112ca6e0e55150d2fdbc704474530">Game::~Game</a></div><div class="ttdeci">~Game()</div><div class="ttdoc">Destructor. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00104">Game.cpp:104</a></div></div>
<div class="ttc" id="class_game_html_a25c49dd9183cb89c0c3e3c34d69389c7"><div class="ttname"><a href="class_game.html#a25c49dd9183cb89c0c3e3c34d69389c7">Game::toggle_camera_free_mode</a></div><div class="ttdeci">void toggle_camera_free_mode()</div><div class="ttdoc">Toggles the free camera movement mode. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00626">Game.cpp:626</a></div></div>
<div class="ttc" id="class_game_log_html_a8e8630c1d2b3899de9a90473fd46c415"><div class="ttname"><a href="class_game_log.html#a8e8630c1d2b3899de9a90473fd46c415">GameLog::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">Clears the game&amp;#39;s log by deleting all it&amp;#39;s entries. </div><div class="ttdef"><b>Definition:</b> <a href="_game_log_8cpp_source.html#l00008">GameLog.cpp:8</a></div></div>
<div class="ttc" id="classlpp_1_1_script_html_a9ca5b255301a8e9a1aedc15e62fe677c"><div class="ttname"><a href="classlpp_1_1_script.html#a9ca5b255301a8e9a1aedc15e62fe677c">lpp::Script::instance</a></div><div class="ttdeci">static Script &amp; instance()</div><div class="ttdoc">Returns a reference to the lpp::Script singleton. </div><div class="ttdef"><b>Definition:</b> <a href="_lpp_script_8cpp_source.html#l00105">LppScript.cpp:105</a></div></div>
<div class="ttc" id="class_game_html_a215e7330ada9260773a74ad0347dd638"><div class="ttname"><a href="class_game.html#a215e7330ada9260773a74ad0347dd638">Game::get_mouse_click_position</a></div><div class="ttdeci">std::pair&lt; bool, Ogre::Vector3 &gt; get_mouse_click_position(const OIS::MouseEvent &amp;) const </div><div class="ttdoc">Returns a pair consisting of the location of the point where the player clicked on the ground plane a...</div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00631">Game.cpp:631</a></div></div>
<div class="ttc" id="class_game_html_a64bfdd3eb56fb04275ec65bfa3ae12f6"><div class="ttname"><a href="class_game.html#a64bfdd3eb56fb04275ec65bfa3ae12f6">Game::reset_unlocks</a></div><div class="ttdeci">void reset_unlocks()</div><div class="ttdoc">Restores the unlocks to their initial state. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00236">Game.cpp:236</a></div></div>
<div class="ttc" id="class_health_system_html"><div class="ttname"><a href="class_health_system.html">HealthSystem</a></div><div class="ttdoc">System that manages the regeneration and health of entities on each frame. </div><div class="ttdef"><b>Definition:</b> <a href="_health_system_8hpp_source.html#l00011">HealthSystem.hpp:11</a></div></div>
<div class="ttc" id="class_game_html_a16f63fa6189119f189b90129558af639"><div class="ttname"><a href="class_game.html#a16f63fa6189119f189b90129558af639">Game::spell_caster_</a></div><div class="ttdeci">std::unique_ptr&lt; Spellcaster &gt; spell_caster_</div><div class="ttdoc">Allows the player to cast spells of different types (positional, targeted etc.). </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00288">Game.hpp:288</a></div></div>
<div class="ttc" id="class_game_html_abd514cad4e3b88d5ab87e8f2e966fd4a"><div class="ttname"><a href="class_game.html#abd514cad4e3b88d5ab87e8f2e966fd4a">Game::mouse_position_</a></div><div class="ttdeci">Ogre::Vector2 mouse_position_</div><div class="ttdoc">Saved position of the mouse cursor (2D). </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00277">Game.hpp:277</a></div></div>
<div class="ttc" id="class_player_html_a9a4272f12d53223a552c27a064e65187"><div class="ttname"><a href="class_player.html#a9a4272f12d53223a552c27a064e65187">Player::instance</a></div><div class="ttdeci">static Player &amp; instance()</div><div class="ttdoc">Returns a reference to the singleton instance. </div><div class="ttdef"><b>Definition:</b> <a href="_player_8hpp_source.html#l00140">Player.hpp:140</a></div></div>
<div class="ttc" id="class_game_html_af379c92d7e4e03982bcbeb53f4d3edb5"><div class="ttname"><a href="class_game.html#af379c92d7e4e03982bcbeb53f4d3edb5">Game::new_game</a></div><div class="ttdeci">void new_game(tdt::uint, tdt::uint)</div><div class="ttdoc">Creates a new game with the given dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00172">Game.cpp:172</a></div></div>
<div class="ttc" id="class_time_system_html"><div class="ttname"><a href="class_time_system.html">TimeSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="_time_system_8hpp_source.html#l00009">TimeSystem.hpp:9</a></div></div>
<div class="ttc" id="class_player_html_a1af5d39f7bac2aeaa1e30c7dda2332fa"><div class="ttname"><a href="class_player.html#a1af5d39f7bac2aeaa1e30c7dda2332fa">Player::reset</a></div><div class="ttdeci">void reset()</div><div class="ttdoc">Sets all of the player&amp;#39;s stats to their default values. </div><div class="ttdef"><b>Definition:</b> <a href="_player_8cpp_source.html#l00217">Player.cpp:217</a></div></div>
<div class="ttc" id="class_player_html_a30c0caf810fab1b1676a6ce4f76b1f42"><div class="ttname"><a href="class_player.html#a30c0caf810fab1b1676a6ce4f76b1f42">Player::init</a></div><div class="ttdeci">void init(EntitySystem *)</div><div class="ttdoc">Initializes the player class. </div><div class="ttdef"><b>Definition:</b> <a href="_player_8cpp_source.html#l00008">Player.cpp:8</a></div></div>
<div class="ttc" id="class_game_html_afa42cb4d67e91e865f0df410a3950c33"><div class="ttname"><a href="class_game.html#afa42cb4d67e91e865f0df410a3950c33">Game::keyPressed</a></div><div class="ttdeci">bool keyPressed(const OIS::KeyEvent &amp;) override</div><div class="ttdoc">Called when a key is pressed. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00278">Game.cpp:278</a></div></div>
<div class="ttc" id="class_event_system_html"><div class="ttname"><a href="class_event_system.html">EventSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="_event_system_8hpp_source.html#l00007">EventSystem.hpp:7</a></div></div>
<div class="ttc" id="class_game_html_a5daa13180764435151f08925edd144a3"><div class="ttname"><a href="class_game.html#a5daa13180764435151f08925edd144a3">Game::set_state</a></div><div class="ttdeci">void set_state(GAME_STATE)</div><div class="ttdoc">Changes the game&amp;#39;s state. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00154">Game.cpp:154</a></div></div>
<div class="ttc" id="class_wave_system_html"><div class="ttname"><a href="class_wave_system.html">WaveSystem</a></div><div class="ttdoc">This system creates the entities attacking the player&amp;#39;s dungeon in a similar fashion to tower defense...</div><div class="ttdef"><b>Definition:</b> <a href="_wave_system_8hpp_source.html#l00025">WaveSystem.hpp:25</a></div></div>
<div class="ttc" id="class_game_html_a20ded9865809df42b8e6d6dd5292351c"><div class="ttname"><a href="class_game.html#a20ded9865809df42b8e6d6dd5292351c">Game::set_throne_id</a></div><div class="ttdeci">void set_throne_id(tdt::uint)</div><div class="ttdoc">Sets the ID of the entity that represents the Dungeon Throne. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00254">Game.cpp:254</a></div></div>
<div class="ttc" id="class_game_html_ad59df6562a58a614fda24622d3715b65"><div class="ttname"><a href="class_game.html#ad59df6562a58a614fda24622d3715b65">Game::Game</a></div><div class="ttdeci">Game()</div><div class="ttdoc">Constructor. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00030">Game.cpp:30</a></div></div>
<div class="ttc" id="class_camera_html"><div class="ttname"><a href="class_camera.html">Camera</a></div><div class="ttdoc">Class wrapping the Ogre camera object, allowing RTS-like movement and switching to free mode...</div><div class="ttdef"><b>Definition:</b> <a href="_camera_8hpp_source.html#l00013">Camera.hpp:13</a></div></div>
<div class="ttc" id="class_lua_interface_html_ac9fa6b609503a1db2c44b7f27f8d1090"><div class="ttname"><a href="class_lua_interface.html#ac9fa6b609503a1db2c44b7f27f8d1090">LuaInterface::init</a></div><div class="ttdeci">static void init(Game *)</div><div class="ttdoc">Sets the lua_this pointer and registers all C++ API functions to Lua. </div><div class="ttdef"><b>Definition:</b> <a href="_lua_interface_8cpp_source.html#l00044">LuaInterface.cpp:44</a></div></div>
<div class="ttc" id="class_game_html_a57ad62417505d7230bc46b37def4f1d0"><div class="ttname"><a href="class_game.html#a57ad62417505d7230bc46b37def4f1d0">Game::create_empty_level</a></div><div class="ttdeci">void create_empty_level(tdt::uint, tdt::uint)</div><div class="ttdoc">Creates an empty level with the given dimensions. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00186">Game.cpp:186</a></div></div>
<div class="ttc" id="class_game_html_a7595cce82f9d32a21ac96663d5927e2b"><div class="ttname"><a href="class_game.html#a7595cce82f9d32a21ac96663d5927e2b">Game::frameRenderingQueued</a></div><div class="ttdeci">bool frameRenderingQueued(const Ogre::FrameEvent &amp;) override</div><div class="ttdoc">Called when the previous frame is queued for rendering, used for game updates. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00264">Game.cpp:264</a></div></div>
<div class="ttc" id="class_g_u_i_html_a37c94218f5c1d9d9b955ee7796ba9247"><div class="ttname"><a href="class_g_u_i.html#a37c94218f5c1d9d9b955ee7796ba9247">GUI::set_visible</a></div><div class="ttdeci">void set_visible(bool)</div><div class="ttdoc">Set&amp;#39;s the GUI&amp;#39;s visibility status. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00315">GUI.cpp:315</a></div></div>
<div class="ttc" id="class_movement_system_html"><div class="ttname"><a href="class_movement_system.html">MovementSystem</a></div><div class="ttdoc">System handling movement related updates and containing movement &amp; physics related methods...</div><div class="ttdef"><b>Definition:</b> <a href="_movement_system_8hpp_source.html#l00010">MovementSystem.hpp:10</a></div></div>
<div class="ttc" id="class_trigger_system_html"><div class="ttname"><a href="class_trigger_system.html">TriggerSystem</a></div><div class="ttdoc">Handles triggers by checking if an entity is standing in their radius when they are off cooldowns...</div><div class="ttdef"><b>Definition:</b> <a href="_trigger_system_8hpp_source.html#l00011">TriggerSystem.hpp:11</a></div></div>
<div class="ttc" id="class_combat_system_html"><div class="ttname"><a href="class_combat_system.html">CombatSystem</a></div><div class="ttdoc">Manages auto attack melee and ranged combat, special melee and ranged attacks will be both handled by...</div><div class="ttdef"><b>Definition:</b> <a href="_combat_system_8hpp_source.html#l00028">CombatSystem.hpp:28</a></div></div>
<div class="ttc" id="class_game_html_af65edfac010ab689d4f1750de04a3635"><div class="ttname"><a href="class_game.html#af65edfac010ab689d4f1750de04a3635">Game::mouseMoved</a></div><div class="ttdeci">bool mouseMoved(const OIS::MouseEvent &amp;) override</div><div class="ttdoc">Called when the mouse is moved. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00348">Game.cpp:348</a></div></div>
<div class="ttc" id="class_research_window_html_a47234d07778e8f3a29b0be59ce6c275f"><div class="ttname"><a href="class_research_window.html#a47234d07778e8f3a29b0be59ce6c275f">ResearchWindow::reset_research</a></div><div class="ttdeci">void reset_research()</div><div class="ttdoc">Resets the research state so that all items can be unlocked again. </div><div class="ttdef"><b>Definition:</b> <a href="_research_window_8cpp_source.html#l00068">ResearchWindow.cpp:68</a></div></div>
<div class="ttc" id="class_game_html_a6c94b1e2b66f522a3ccfe4294d0311d9"><div class="ttname"><a href="class_game.html#a6c94b1e2b66f522a3ccfe4294d0311d9">Game::ogre_init</a></div><div class="ttdeci">void ogre_init()</div><div class="ttdoc">Init methods. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00503">Game.cpp:503</a></div></div>
<div class="ttc" id="class_console_html_ac3fa9f9078ac81af758ad0bec7a10bf8"><div class="ttname"><a href="class_console.html#ac3fa9f9078ac81af758ad0bec7a10bf8">Console::update_fps</a></div><div class="ttdeci">void update_fps(tdt::real, tdt::real)</div><div class="ttdoc">Updates the FPS value next to the console name. </div><div class="ttdef"><b>Definition:</b> <a href="_console_8cpp_source.html#l00110">Console.cpp:110</a></div></div>
<div class="ttc" id="class_game_html_a27543a5588f79f251f5b4cb64026966f"><div class="ttname"><a href="class_game.html#a27543a5588f79f251f5b4cb64026966f">Game::game_serializer_</a></div><div class="ttdeci">std::unique_ptr&lt; GameSerializer &gt; game_serializer_</div><div class="ttdoc">Used to save the game. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00218">Game.hpp:218</a></div></div>
<div class="ttc" id="class_input_system_html"><div class="ttname"><a href="class_input_system.html">InputSystem</a></div><div class="ttdoc">System handling entities controlled by the player&amp;#39;s keyboard input and changing the game&amp;#39;s view mode ...</div><div class="ttdef"><b>Definition:</b> <a href="_input_system_8hpp_source.html#l00016">InputSystem.hpp:16</a></div></div>
<div class="ttc" id="class_grid_html_a23e1873e2854d15170ae8565e46a1729"><div class="ttname"><a href="class_grid.html#a23e1873e2854d15170ae8565e46a1729">Grid::create_graph</a></div><div class="ttdeci">void create_graph(EntitySystem &amp;, Ogre::Vector2, tdt::uint, tdt::uint, tdt::real)</div><div class="ttdoc">Generates a grid graph with the given parameters to be used for pathfinding. </div><div class="ttdef"><b>Definition:</b> <a href="_grid_8cpp_source.html#l00112">Grid.cpp:112</a></div></div>
<div class="ttc" id="class_game_html_a4faa3b6fdf7446e3e432d3a7cf49e6b2"><div class="ttname"><a href="class_game.html#a4faa3b6fdf7446e3e432d3a7cf49e6b2">Game::reset_camera</a></div><div class="ttdeci">void reset_camera()</div><div class="ttdoc">Resets the main camera&amp;#39;s position and orientation to it&amp;#39;s original state. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00231">Game.cpp:231</a></div></div>
<div class="ttc" id="class_g_u_i_html_ac5d029ac1d5be5f405d0bb9b4beaadeb"><div class="ttname"><a href="class_g_u_i.html#ac5d029ac1d5be5f405d0bb9b4beaadeb">GUI::get_log</a></div><div class="ttdeci">GameLog &amp; get_log()</div><div class="ttdoc">Returns a reference to the game&amp;#39;s log. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00379">GUI.cpp:379</a></div></div>
<div class="ttc" id="class_grid_html_a6ce0a23ca91244b4eee86ba8072cb56d"><div class="ttname"><a href="class_grid.html#a6ce0a23ca91244b4eee86ba8072cb56d">Grid::instance</a></div><div class="ttdeci">static Grid &amp; instance()</div><div class="ttdoc">Returns a reference to the static instance of this class. </div><div class="ttdef"><b>Definition:</b> <a href="_grid_8cpp_source.html#l00156">Grid.cpp:156</a></div></div>
<div class="ttc" id="class_game_html_a30dbe1a49eeef33b8bfdba3275e03b81"><div class="ttname"><a href="class_game.html#a30dbe1a49eeef33b8bfdba3275e03b81">Game::keyReleased</a></div><div class="ttdeci">bool keyReleased(const OIS::KeyEvent &amp;) override</div><div class="ttdoc">Called when a key is released. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00318">Game.cpp:318</a></div></div>
<div class="ttc" id="class_g_u_i_html_ad68dfd48d702edbc8eae79b02ef694db"><div class="ttname"><a href="class_g_u_i.html#ad68dfd48d702edbc8eae79b02ef694db">GUI::get_spell_casting</a></div><div class="ttdeci">SpellCastingWindow &amp; get_spell_casting()</div><div class="ttdoc">Returns a reference to the spell casting window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00399">GUI.cpp:399</a></div></div>
<div class="ttc" id="class_g_u_i_html_adf043e9ed8ec60a8ac7f981dbd3d7933"><div class="ttname"><a href="class_g_u_i.html#adf043e9ed8ec60a8ac7f981dbd3d7933">GUI::get_options</a></div><div class="ttdeci">OptionsWindow &amp; get_options()</div><div class="ttdoc">Returns a reference to the options window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00409">GUI.cpp:409</a></div></div>
<div class="ttc" id="class_spellcaster_html"><div class="ttname"><a href="class_spellcaster.html">Spellcaster</a></div><div class="ttdoc">A utility class that manages the player&amp;#39;s spell casting and is usually called from input handlers and...</div><div class="ttdef"><b>Definition:</b> <a href="_spellcaster_8hpp_source.html#l00018">Spellcaster.hpp:18</a></div></div>
<div class="ttc" id="class_game_html_a180d400b3d9f3781f31822f9141704b2"><div class="ttname"><a href="class_game.html#a180d400b3d9f3781f31822f9141704b2">Game::level_generator_</a></div><div class="ttdeci">std::unique_ptr&lt; level_generators::LevelGenerator &gt; level_generator_</div><div class="ttdoc">Used to create new levels (that is, to distribute walls and gold deposits). </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00283">Game.hpp:283</a></div></div>
<div class="ttc" id="class_g_u_i_html_a3533e8d1c67c8cd1643be0b6d640e489"><div class="ttname"><a href="class_g_u_i.html#a3533e8d1c67c8cd1643be0b6d640e489">GUI::get_builder</a></div><div class="ttdeci">BuilderWindow &amp; get_builder()</div><div class="ttdoc">Returns a reference to the builder window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00384">GUI.cpp:384</a></div></div>
<div class="ttc" id="class_game_html_a8a1c953c9c8ca4ef292e5fa6fec4dcb0"><div class="ttname"><a href="class_game.html#a8a1c953c9c8ca4ef292e5fa6fec4dcb0">Game::ois_to_cegui</a></div><div class="ttdeci">CEGUI::MouseButton ois_to_cegui(OIS::MouseButtonID)</div><div class="ttdoc">Converts an OIS key code to CEGUI key code. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00611">Game.cpp:611</a></div></div>
<div class="ttc" id="class_g_u_i_html_af7f76a45f16144b8217938de6facb97d"><div class="ttname"><a href="class_g_u_i.html#af7f76a45f16144b8217938de6facb97d">GUI::get_message</a></div><div class="ttdeci">MessageToPlayerWindow &amp; get_message()</div><div class="ttdoc">Returns a reference to the message to player window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00404">GUI.cpp:404</a></div></div>
<div class="ttc" id="class_graphics_system_html"><div class="ttname"><a href="class_graphics_system.html">GraphicsSystem</a></div><div class="ttdoc">System that performs all graphics related updates. </div><div class="ttdef"><b>Definition:</b> <a href="_graphics_system_8hpp_source.html#l00010">GraphicsSystem.hpp:10</a></div></div>
<div class="ttc" id="class_game_html_a8e687faa09ca8c2f89279eecbe463916"><div class="ttname"><a href="class_game.html#a8e687faa09ca8c2f89279eecbe463916">Game::ground_</a></div><div class="ttdeci">std::unique_ptr&lt; Ogre::Plane &gt; ground_</div><div class="ttdoc">The game&amp;#39;s ground represented by a plane, used for ray intersections. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00244">Game.hpp:244</a></div></div>
<div class="ttc" id="class_top_bar_html_a8641f2accd0f13d2262669914582cb69"><div class="ttname"><a href="class_top_bar.html#a8641f2accd0f13d2262669914582cb69">TopBar::update_time</a></div><div class="ttdeci">void update_time(tdt::real)</div><div class="ttdoc">Updates the current time on the top bar if a second passed since the last time update. </div><div class="ttdef"><b>Definition:</b> <a href="_top_bar_8cpp_source.html#l00009">TopBar.cpp:9</a></div></div>
<div class="ttc" id="class_game_html_ab64dd8e6b94e4ea96da9cba633524cdb"><div class="ttname"><a href="class_game.html#ab64dd8e6b94e4ea96da9cba633524cdb">Game::entity_system_</a></div><div class="ttdeci">std::unique_ptr&lt; EntitySystem &gt; entity_system_</div><div class="ttdoc">Unique pointers to systems (sadly all systems require the EntitySystem, which requires Ogre::SceneMan...</div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00199">Game.hpp:199</a></div></div>
<div class="ttc" id="classlevel__generators_1_1_random_level_generator_html"><div class="ttname"><a href="classlevel__generators_1_1_random_level_generator.html">level_generators::RandomLevelGenerator</a></div><div class="ttdoc">Level generator that uses simple RNG approach (counts the number of gold neighbours and increases the...</div><div class="ttdef"><b>Definition:</b> <a href="_level_generators_8hpp_source.html#l00060">LevelGenerators.hpp:60</a></div></div>
<div class="ttc" id="class_entity_creator_html"><div class="ttname"><a href="class_entity_creator.html">EntityCreator</a></div><div class="ttdoc">Class representing the debugging GUI window used to place and create entities during runtime...</div><div class="ttdef"><b>Definition:</b> <a href="_entity_creator_8hpp_source.html#l00014">EntityCreator.hpp:14</a></div></div>
<div class="ttc" id="class_mana_spell_system_html"><div class="ttname"><a href="class_mana_spell_system.html">ManaSpellSystem</a></div><div class="ttdoc">Regenerates mana to the player and all entities that have mana. </div><div class="ttdef"><b>Definition:</b> <a href="_mana_spell_system_8hpp_source.html#l00011">ManaSpellSystem.hpp:11</a></div></div>
<div class="ttc" id="class_g_u_i_html_a8f8dae1e40b3f25c179cd088631e9e24"><div class="ttname"><a href="class_g_u_i.html#a8f8dae1e40b3f25c179cd088631e9e24">GUI::get_research</a></div><div class="ttdeci">ResearchWindow &amp; get_research()</div><div class="ttdoc">Returns a reference to the research window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00394">GUI.cpp:394</a></div></div>
<div class="ttc" id="class_task_system_html"><div class="ttname"><a href="class_task_system.html">TaskSystem</a></div><div class="ttdoc">System managing all entities with the TaskComponent, their creation, assignment, lifetime checks and ...</div><div class="ttdef"><b>Definition:</b> <a href="_task_system_8hpp_source.html#l00018">TaskSystem.hpp:18</a></div></div>
<div class="ttc" id="class_game_html_a55d453a75a2abc8a0b2ba4ad6265b8c3"><div class="ttname"><a href="class_game.html#a55d453a75a2abc8a0b2ba4ad6265b8c3">Game::renderer_</a></div><div class="ttdeci">CEGUI::OgreRenderer * renderer_</div><div class="ttdoc">CEGUI renderer. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00228">Game.hpp:228</a></div></div>
<div class="ttc" id="class_g_u_i_html_a169694dda858ea12986f00ee32ac7add"><div class="ttname"><a href="class_g_u_i.html#a169694dda858ea12986f00ee32ac7add">GUI::instance</a></div><div class="ttdeci">static GUI &amp; instance()</div><div class="ttdoc">Returns the singleton instance. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00335">GUI.cpp:335</a></div></div>
<div class="ttc" id="class_game_html_ab0c5032f689e8e704086a83bf57e3f26"><div class="ttname"><a href="class_game.html#ab0c5032f689e8e704086a83bf57e3f26">Game::state_</a></div><div class="ttdeci">GAME_STATE state_</div><div class="ttdoc">Current game state. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00174">Game.hpp:174</a></div></div>
<div class="ttc" id="class_game_html_af49a6f70e2392c419e0bbc6157b809a4"><div class="ttname"><a href="class_game.html#af49a6f70e2392c419e0bbc6157b809a4">Game::selection_box_</a></div><div class="ttdeci">std::unique_ptr&lt; SelectionBox &gt; selection_box_</div><div class="ttdoc">Selection box used to select multiple entities at once. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00266">Game.hpp:266</a></div></div>
<div class="ttc" id="class_game_html_ac04dd2e6cc4b77fa09d234446ff7d1ca"><div class="ttname"><a href="class_game.html#ac04dd2e6cc4b77fa09d234446ff7d1ca">Game::windowResized</a></div><div class="ttdeci">void windowResized(Ogre::RenderWindow *rw) override</div><div class="ttdoc">Called when the window is resized. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00471">Game.cpp:471</a></div></div>
<div class="ttc" id="class_player_html_a150b3f80378da1ab09eef2a59cf9b173"><div class="ttname"><a href="class_player.html#a150b3f80378da1ab09eef2a59cf9b173">Player::set_initial_unlocks</a></div><div class="ttdeci">void set_initial_unlocks(const std::vector&lt; std::string &gt; &amp;, const std::vector&lt; std::string &gt; &amp;)</div><div class="ttdoc">Sets the spells and buildings that are unlocked from the start. </div><div class="ttdef"><b>Definition:</b> <a href="_player_8cpp_source.html#l00014">Player.cpp:14</a></div></div>
<div class="ttc" id="class_a_i_system_html"><div class="ttname"><a href="class_a_i_system.html">AISystem</a></div><div class="ttdoc">System handling the AI of entities by calling their update method every frame. </div><div class="ttdef"><b>Definition:</b> <a href="_a_i_system_8hpp_source.html#l00010">AISystem.hpp:10</a></div></div>
<div class="ttc" id="class_game_html_add2c7263d03befb832ce112ccf09b3eb"><div class="ttname"><a href="class_game.html#add2c7263d03befb832ce112ccf09b3eb">Game::throne_id_</a></div><div class="ttdeci">tdt::uint throne_id_</div><div class="ttdoc">ID of the entity representing the Dungeon Throne, losing which ends the game. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00294">Game.hpp:294</a></div></div>
<div class="ttc" id="class_game_html_a1ab78f5ed0d5ea879157357cf2fb2afa"><div class="ttname"><a href="class_game.html#a1ab78f5ed0d5ea879157357cf2fb2afa">Game::run</a></div><div class="ttdeci">void run()</div><div class="ttdoc">Starts the game. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00110">Game.cpp:110</a></div></div>
<div class="ttc" id="class_game_html_a484567626eb22fe9fc65c51a3914e230"><div class="ttname"><a href="class_game.html#a484567626eb22fe9fc65c51a3914e230">Game::update</a></div><div class="ttdeci">void update(tdt::real)</div><div class="ttdoc">Updates the game in one frame. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00118">Game.cpp:118</a></div></div>
<div class="ttc" id="class_game_html_a0376227db8220eefaf7f6ac310c091f7"><div class="ttname"><a href="class_game.html#a0376227db8220eefaf7f6ac310c091f7">Game::main_cam_</a></div><div class="ttdeci">std::unique_ptr&lt; Camera &gt; main_cam_</div><div class="ttdoc">Camera rendering to the window. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00192">Game.hpp:192</a></div></div>
<div class="ttc" id="class_game_serializer_html"><div class="ttname"><a href="class_game_serializer.html">GameSerializer</a></div><div class="ttdoc">Class that is used to save (by using Lua code generation) and loading the game (by executing said cod...</div><div class="ttdef"><b>Definition:</b> <a href="_game_serializer_8hpp_source.html#l00022">GameSerializer.hpp:22</a></div></div>
<div class="ttc" id="class_entity_tracker_html_abff80cf0f55c307745c5f88f219099a1"><div class="ttname"><a href="class_entity_tracker.html#abff80cf0f55c307745c5f88f219099a1">EntityTracker::set_tracked_entity</a></div><div class="ttdeci">void set_tracked_entity(tdt::uint, EntitySystem &amp;)</div><div class="ttdoc">Sets the new tracked entity and loads it&amp;#39;s data. </div><div class="ttdef"><b>Definition:</b> <a href="_entity_tracker_8cpp_source.html#l00011">EntityTracker.cpp:11</a></div></div>
<div class="ttc" id="class_g_u_i_html_a57b2102ded949460275f6c06a73ef472"><div class="ttname"><a href="class_g_u_i.html#a57b2102ded949460275f6c06a73ef472">GUI::get_top_bar</a></div><div class="ttdeci">TopBar &amp; get_top_bar()</div><div class="ttdoc">Returns a reference to the top bar. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00389">GUI.cpp:389</a></div></div>
<div class="ttc" id="class_game_html_af594421c81bec3f6284ccdb8d3888080"><div class="ttname"><a href="class_game.html#af594421c81bec3f6284ccdb8d3888080">Game::systems_</a></div><div class="ttdeci">std::vector&lt; System * &gt; systems_</div><div class="ttdoc">Vector of all systems used for updating the game&amp;#39;s logic. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00223">Game.hpp:223</a></div></div>
<div class="ttc" id="class_g_u_i_html_ab197361fb542ae6f1761be27346ec6bd"><div class="ttname"><a href="class_g_u_i.html#ab197361fb542ae6f1761be27346ec6bd">GUI::get_tracker</a></div><div class="ttdeci">EntityTracker &amp; get_tracker()</div><div class="ttdoc">Returns a reference to the entity tracker. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00374">GUI.cpp:374</a></div></div>
<div class="ttc" id="class_game_html_a11e7bc665ccfcd21403f8fad66deb24e"><div class="ttname"><a href="class_game.html#a11e7bc665ccfcd21403f8fad66deb24e">Game::get_throne_id</a></div><div class="ttdeci">tdt::uint get_throne_id() const </div><div class="ttdoc">Returns the ID of the entity that represents the Dungeon Throne. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00259">Game.cpp:259</a></div></div>
<div class="ttc" id="class_grid_html_ad31b555e83f82a18c1c4a483bf1e57e5"><div class="ttname"><a href="class_grid.html#ad31b555e83f82a18c1c4a483bf1e57e5">Grid::get_center_position</a></div><div class="ttdeci">Ogre::Vector2 get_center_position(EntitySystem &amp;) const </div><div class="ttdoc">Returns the 2D position of the central node of the grid (or one of them if the grid has even dimensio...</div><div class="ttdef"><b>Definition:</b> <a href="_grid_8cpp_source.html#l00171">Grid.cpp:171</a></div></div>
<div class="ttc" id="class_selection_box_html"><div class="ttname"><a href="class_selection_box.html">SelectionBox</a></div><div class="ttdoc">Class representing the ingame selection box (created by moving the left mouse while pressing the left...</div><div class="ttdef"><b>Definition:</b> <a href="_selection_box_8hpp_source.html#l00013">SelectionBox.hpp:13</a></div></div>
<div class="ttc" id="class_game_html_a9ce203f7a53ba536a1d7653f7e74d05f"><div class="ttname"><a href="class_game.html#a9ce203f7a53ba536a1d7653f7e74d05f">Game::placer_</a></div><div class="ttdeci">std::unique_ptr&lt; EntityPlacer &gt; placer_</div><div class="ttdoc">Allows to spawn entities with the mouse ingame. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00239">Game.hpp:239</a></div></div>
<div class="ttc" id="class_game_html_a13668cabb42e440fea0f0a2a2b211984"><div class="ttname"><a href="class_game.html#a13668cabb42e440fea0f0a2a2b211984">Game::ground_entity_</a></div><div class="ttdeci">Ogre::Entity * ground_entity_</div><div class="ttdoc">Entity holding the ground plane. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00249">Game.hpp:249</a></div></div>
<div class="ttc" id="class_g_u_i_window_html_afaa290bb3bb0020e676bb546d942e528"><div class="ttname"><a href="class_g_u_i_window.html#afaa290bb3bb0020e676bb546d942e528">GUIWindow::set_visible</a></div><div class="ttdeci">virtual void set_visible(bool)</div><div class="ttdoc">Sets the visibolity status of this window. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_window_8cpp_source.html#l00014">GUIWindow.cpp:14</a></div></div>
<div class="ttc" id="class_game_html_ad5a3e4b03b13386ab6dd759017573821"><div class="ttname"><a href="class_game.html#ad5a3e4b03b13386ab6dd759017573821">Game::entity_creator_</a></div><div class="ttdeci">std::unique_ptr&lt; EntityCreator &gt; entity_creator_</div><div class="ttdoc">A gui window that allows to place entities selected from a menu. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00272">Game.hpp:272</a></div></div>
<div class="ttc" id="class_g_u_i_html_ae407027b2e7e81f8132ee7dd5252c456"><div class="ttname"><a href="class_g_u_i.html#ae407027b2e7e81f8132ee7dd5252c456">GUI::get_console</a></div><div class="ttdeci">Console &amp; get_console()</div><div class="ttdoc">Returns a reference to the game&amp;#39;s dev console. </div><div class="ttdef"><b>Definition:</b> <a href="_g_u_i_8cpp_source.html#l00369">GUI.cpp:369</a></div></div>
<div class="ttc" id="class_game_html_ac427345eb3f0b4aa9a6a4a29a195cc61"><div class="ttname"><a href="class_game.html#ac427345eb3f0b4aa9a6a4a29a195cc61">Game::root_</a></div><div class="ttdeci">std::unique_ptr&lt; Ogre::Root &gt; root_</div><div class="ttdoc">Pointers to Ogre3D objects. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8hpp_source.html#l00179">Game.hpp:179</a></div></div>
<div class="ttc" id="class_game_html_a32b8ef3a9f1d9103ad4560ca212c2ab1"><div class="ttname"><a href="class_game.html#a32b8ef3a9f1d9103ad4560ca212c2ab1">Game::mouseReleased</a></div><div class="ttdeci">bool mouseReleased(const OIS::MouseEvent &amp;, OIS::MouseButtonID) override</div><div class="ttdoc">Called when a mouse button is released. </div><div class="ttdef"><b>Definition:</b> <a href="_game_8cpp_source.html#l00435">Game.cpp:435</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><b>Game.cpp</b></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
